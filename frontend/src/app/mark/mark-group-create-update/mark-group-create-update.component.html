<oc-title-bar>
    <span>{{ 'i18n.modules.mark.group.createUpdate.' + (isEditMode() ? 'update' : 'create') + '.title' | translate }}</span>
</oc-title-bar>
<form [formGroup]="markGroupCreateUpdateForm" (submit)="submit()" fxFlex fxFlex.gt-sm="60" fxFlexOffset.gt-sm="20">
    <div class="form-group">
        <div class="half">
            <md-input-container>
                <input mdInput
                       [placeholder]="'i18n.modules.mark.createUpdate.form.weight.label' | translate"
                       formControlName="weight">
                <md-error
                    *ngIf="markGroupCreateUpdateForm.get('weight').invalid && markGroupCreateUpdateForm.get('weight').touched">
                    <ng-template [ngIf]="markGroupCreateUpdateForm.get('weight').hasError('required')">
                        {{ 'i18n.common.form.error.required' | translate }}
                    </ng-template>
                    <ng-template [ngIf]="markGroupCreateUpdateForm.get('weight').hasError('pattern')">
                        {{ 'i18n.modules.mark.createUpdate.form.weight.error.pattern' | translate }}
                    </ng-template>
                </md-error>
            </md-input-container>
        </div>
    </div>
    <div class="form-group">
        <md-input-container>
            <input mdInput
                   [placeholder]="'i18n.modules.mark.group.createUpdate.form.description.label' | translate"
                   formControlName="description"
                   maxlength="100" #description>
            <md-hint align="end">{{description.value.length}} / 100</md-hint>
            <md-error
                *ngIf="markGroupCreateUpdateForm.get('description').invalid && markGroupCreateUpdateForm.get('description').touched">
                <ng-template [ngIf]="markGroupCreateUpdateForm.get('description').hasError('required')">
                    {{ 'i18n.common.form.error.required' | translate }}
                </ng-template>
            </md-error>
        </md-input-container>
    </div>
    <div formArrayName="selectedMarks" *ngIf="selectedMarks.controls.length > 0">
        <div class="form-group dynamic-mark" *ngFor="let markControl of selectedMarks.controls; let i=index">
            <md-select [formControlName]="i">
                <md-option *ngFor="let availableMark of getAvailableMarks(i)" [value]="availableMark">
                    {{ availableMark.description }}
                </md-option>
            </md-select>
            <button md-raised-button (click)="removeMark$.next(i)">
                <md-icon>remove_circle_outline</md-icon>
            </button>
        </div>
    </div>
    <div class="form-group">
        <md-select (change)="newMark$.next($event.value)" [disabled]="hasMarksLeft()"
                   [placeholder]="'i18n.modules.mark.group.createUpdate.form.selectMark.label' | translate">
            <md-option *ngFor="let mark of getAvailableMarks()" [value]="mark">
                {{ mark.description }}
            </md-option>
        </md-select>
    </div>
    <div>
        <button md-button>{{ 'i18n.common.action.cancel' | translate }}</button>
        <button md-raised-button color="primary" type="submit">{{ 'i18n.common.action.save' | translate }}</button>
    </div>
</form>
