<div class="dialog-header">
    <h1 mat-dialog-title>{{ 'i18n.modules.exam.add' | translate }}</h1>
</div>
<form [formGroup]="examCreateUpdateForm" (submit)="submit()">
    <div class="dialog-body" mat-dialog-content>
        <div class="form-group">
            <mat-form-field>
                <input matInput
                       required
                       [placeholder]="'i18n.modules.exam.dialogs.add.name.label' | translate"
                       formControlName="name">
                <mat-error *ngIf="examCreateUpdateForm.get('name').hasError('required')">
                    {{ 'i18n.common.form.error.required' | translate }}
                </mat-error>
            </mat-form-field>
        </div>
        <div class="form-group">
            <mat-form-field>
                <textarea matInput
                          [placeholder]="'i18n.modules.exam.dialogs.add.desc.label' | translate"
                          formControlName="description"></textarea>
                <mat-error *ngIf="examCreateUpdateForm.get('description').hasError('required')">
                    {{ 'i18n.common.form.error.required' | translate }}
                </mat-error>
            </mat-form-field>
        </div>
        <div class="form-group half responsive">
            <div class="half-child">
                <mat-form-field>
                    <input matInput
                           required
                           [matDatepicker]="examDatePicker"
                           [placeholder]="'i18n.common.label.dueDate' | translate"
                           formControlName="date">
                    <mat-datepicker-toggle matSuffix [for]="examDatePicker"></mat-datepicker-toggle>
                    <mat-datepicker #examDatePicker
                                    [touchUi]="isMobile()">
                    </mat-datepicker>
                    <mat-error>
                        <ng-template [ngIf]="examCreateUpdateForm.get('date').hasError('required')">
                            {{ 'i18n.common.form.error.required' | translate }}
                        </ng-template>
                        <ng-template [ngIf]="examCreateUpdateForm.get('date').hasError('date')">
                            {{ 'i18n.common.form.error.datePattern' | translate }}
                        </ng-template>
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="half-child">
                <mat-form-field>
                    <mat-select formControlName="subjectId"
                                required
                                [placeholder]="'i18n.modules.exam.dialogs.add.subject.label' | translate">
                        <mat-option *ngFor="let subject of subjects"
                                    [value]="subject.id">
                            {{ subject.name }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>

        <div formArrayName="examTasks" class="form-group exam-tasks">
            <h5>{{ 'i18n.modules.exam.examTask.title' | translate }}</h5>
            <button mat-button
                    type="button"
                    color="accent"
                    [disabled]="examTaskArray.length >= 15"
                    (click)="addExamTask()">
                {{ 'i18n.modules.exam.examTask.add' | translate }}
            </button>
            <mat-list>
                <mat-list-item *ngFor="let examTask of examTaskArray.controls; let i=index" [formGroupName]="i">
                    <mat-form-field>
                        <mat-checkbox matPrefix formControlName="finished"></mat-checkbox>
                        <input matInput formControlName="task">
                    </mat-form-field>
                    <button mat-icon-button (click)="removeExamTask(i)">
                        <mat-icon>delete</mat-icon>
                    </button>
                </mat-list-item>
            </mat-list>
        </div>
    </div>
    <div class="dialog-footer" mat-dialog-actions>
        <div class="footer-right">
            <button mat-button
                    type="button"
                    mat-dialog-close>
                {{ 'i18n.common.action.cancel' | translate }}
            </button>
            <button mat-raised-button
                    color="primary"
                    type="submit">
                {{ 'i18n.common.action.save' | translate }}
            </button>
        </div>
    </div>
</form>
