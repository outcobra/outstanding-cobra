<div class="dialog-header">
    <h1 mat-dialog-title>{{ 'i18n.modules.task.add' | translate }}</h1>
</div>
<form [formGroup]="taskCreateUpdateForm" (submit)="submit()">
    <div class="dialog-body" mat-dialog-content>
        <div class="form-group">
            <mat-input-container>
                <input matInput
                       required
                       [placeholder]="'i18n.modules.task.dialogs.add.name.label' | translate"
                       formControlName="name">
                <mat-error *ngIf="taskCreateUpdateForm.get('name').hasError('required')">
                    {{ 'i18n.common.form.error.required' | translate }}
                </mat-error>
            </mat-input-container>
        </div>
        <div class="form-group">
            <mat-input-container>
                <textarea matInput
                          [placeholder]="'i18n.modules.task.dialogs.add.desc.label' | translate"
                          formControlName="description">
                </textarea>
            </mat-input-container>
        </div>
        <div formGroupName="dates" class="form-group">
            <div class="half">
                <div class="half-child">
                    <mat-input-container>
                        <input matInput
                               required
                               [matDatepicker]="todoDatePicker"
                               [min]="today"
                               [placeholder]="'i18n.common.label.todoDate' | translate"
                               formControlName="todoDate">
                        <mat-datepicker-toggle [for]="todoDatePicker"></mat-datepicker-toggle>
                        <mat-error>
                            <ng-template [ngIf]="taskCreateUpdateForm.get('dates.todoDate').hasError('required')">
                                {{ 'i18n.common.form.error.required' | translate }}
                            </ng-template>
                            <ng-template [ngIf]="taskCreateUpdateForm.get('dates.todoDate').hasError('date')">
                                {{ 'i18n.common.form.error.datePattern' | translate }}
                            </ng-template>
                        </mat-error>
                    </mat-input-container>
                    <mat-datepicker #todoDatePicker
                                   [touchUi]="isMobile()">
                    </mat-datepicker>
                </div>
                <div class="half-child">
                    <mat-input-container>
                        <input matInput
                               required
                               [matDatepicker]="dueDatePicker"
                               [min]="today"
                               [placeholder]="'i18n.common.label.dueDate' | translate"
                               formControlName="dueDate">
                        <mat-datepicker-toggle [for]="dueDatePicker"></mat-datepicker-toggle>
                        <mat-error>
                            <ng-template [ngIf]="taskCreateUpdateForm.get('dates.dueDate').hasError('required')">
                                {{ 'i18n.common.form.error.required' | translate }}
                            </ng-template>
                        </mat-error>
                    </mat-input-container>
                    <mat-datepicker #dueDatePicker
                                   [touchUi]="isMobile()">
                    </mat-datepicker>
                </div>
            </div>
            <span class="form-error"
                  *ngIf="taskCreateUpdateForm.get('dates.todoDate').dirty && taskCreateUpdateForm.get('dates.dueDate').dirty && taskCreateUpdateForm.get('dates').invalid">
                <ng-template [ngIf]="taskCreateUpdateForm.get('dates').hasError('dateToIsBeforeDateFrom')">
                    {{ 'i18n.modules.task.dialogs.add.errors.dueDateBeforeTodoDate' | translate }}
                </ng-template>
            </span>
        </div>
        <div class="form-group">
            <mat-input-container>
                <input matInput
                       required
                       type="number"
                       [placeholder]="'i18n.modules.task.dialogs.add.effort.label' | translate"
                       formControlName="effort">
                <mat-error *ngIf="taskCreateUpdateForm.get('effort').hasError('required')">
                    {{ 'i18n.common.form.error.required' | translate }}
                </mat-error>
            </mat-input-container>
        </div>
        <div class="form-group">
            <mat-select formControlName="subjectId"
                       required
                       [placeholder]="'i18n.modules.task.dialogs.add.subject.label' | translate">
                <mat-option *ngFor="let subject of subjects"
                           [value]="subject.id">
                    {{ subject.name }}
                </mat-option>
            </mat-select>
        </div>
    </div>
    <div class="dialog-footer" mat-dialog-actions>
        <div class="footer-right">
            <button mat-button
                    mat-dialog-close>
                {{ 'i18n.common.action.cancel' | translate }}
            </button>
            <button mat-raised-button
                    color="primary"
                    type="submit">{{ 'i18n.common.action.save' | translate }}
            </button>
        </div>
    </div>
</form>
