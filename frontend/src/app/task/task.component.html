<oc-title-bar>
    <span>{{ 'i18n.modules.task.linkTitle' | translate }}</span>
</oc-title-bar>
<ng-template #empty>
    <oc-empty hint="i18n.modules.exam.empty.hint"></oc-empty>
</ng-template>
<div fxLayout fxLayoutAlign="center start" *ngIf="tasks.length > 0; else empty">
    <div class="container" fxFlex fxFlex.gt-sm="960px">
        <md-card class="oc-card">
            <oc-filter-search (search)="search$.next($event)">
                <form ocFilter [formGroup]="filterForm" class="oc-filter-form">
                    <div>
                        <md-select formControlName="subjectId"
                                   [placeholder]="'i18n.modules.exam.filter.subject' | translate"
                                   floatPlaceholder="never">
                            <md-optgroup *ngFor="let schoolClass of filterData.schoolClassSubjects"
                                         [label]="schoolClass.schoolClass.normalizedName">
                                <md-option *ngFor="let subject of schoolClass.subjects" [value]="subject.id">
                                    {{ subject.name }}
                                </md-option>
                            </md-optgroup>
                        </md-select>
                        <button md-icon-button (click)="filterForm.controls['subjectId'].setValue(null)">
                            <md-icon>close</md-icon>
                        </button>
                    </div>
                    <div>
                        <md-checkbox formControlName="finished">
                            {{ 'i18n.modules.task.filter.showPending' | translate }}
                        </md-checkbox>
                    </div>
                </form>
            </oc-filter-search>
            <oc-collapsible *ngFor="let task of filteredTasks">
                <oc-collapsible-header>
                    <task-list-item-header [task]="task"
                                           (markDone)="markTaskAsDone($event)">
                    </task-list-item-header>
                </oc-collapsible-header>
                <task-detail [task]="task"></task-detail>
            </oc-collapsible>
        </md-card>
    </div>
</div>
<button md-fab [mdTooltip]="'i18n.modules.task.add' | translate" mdTooltipPosition="left" (click)="addTask()">
    <md-icon>add</md-icon>
</button>
